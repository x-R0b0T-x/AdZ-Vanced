# ============================================================================# AdZ-Vanced v1.3 - Configuration DNS Web 3.0# Interface PowerShell Dark/Violet Ultra-Stylée# © 2025 KontacktzBot# ============================================================================param([switch]$Debug)Add-Type -AssemblyName System.Windows.FormsAdd-Type -AssemblyName System.Drawing# Déclaration type Win32 pour arrondis (UNE SEULE FOIS)if (-not ("Win32.NativeMethods" -as [type])) {    Add-Type -MemberDefinition @"        [DllImport("gdi32.dll")]        public static extern IntPtr CreateRoundRectRgn(            int nLeftRect, int nTopRect, int nRightRect, int nBottomRect, int nWidthEllipse, int nHeightEllipse);"@ -Name NativeMethods -Namespace Win32}# Vérification privilèges administrateurif (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] 'Administrator')) {    $arguments = "-NoProfile -ExecutionPolicy Bypass -File `"$($MyInvocation.MyCommand.Definition)`""    Start-Process powershell -Verb runAs -ArgumentList $arguments -Wait    exit}# ============================================================================# CONFIGURATION# ============================================================================$script:Config = @{    AppName = "AdZ-Vanced"    Version = "1.3"    DNSIPv4Primary = "45.90.28.219"    DNSIPv4Secondary = "45.90.30.219"    DNSIPv6Primary = "2a07:a8c0::a8:3732"    DNSIPv6Secondary = "2a07:a8c1::a8:3732"    LogoUrl = "https://files.catbox.moe/j3evd5.jpg"    DonationPayPal = "https://www.paypal.com/donate/?hosted_button_id=DMWR5MHMU78H2"    DonationTipeee = "https://fr.tipeee.com/kontacktzbot"    TelegramUrl = "https://t.me/adzvanced"}# Palette couleurs Web 3.0$script:Colors = @{    Purple = [System.Drawing.Color]::FromArgb(147, 51, 234)    PurpleGlow = [System.Drawing.Color]::FromArgb(168, 85, 247)    PurpleLight = [System.Drawing.Color]::FromArgb(196, 181, 253)    Black = [System.Drawing.Color]::FromArgb(15, 15, 20)    BlackSoft = [System.Drawing.Color]::FromArgb(25, 25, 30)    GrayDark = [System.Drawing.Color]::FromArgb(45, 45, 55)    Gray = [System.Drawing.Color]::FromArgb(75, 85, 99)    GrayLight = [System.Drawing.Color]::FromArgb(229, 231, 235)    Green = [System.Drawing.Color]::FromArgb(34, 197, 94)    Red = [System.Drawing.Color]::FromArgb(239, 68, 68)    White = [System.Drawing.Color]::White    Orange = [System.Drawing.Color]::FromArgb(251, 146, 60)}# ============================================================================# FONCTIONS UTILITAIRES# ============================================================================function Write-Log {    param([string]$Message, [string]$Level = "INFO")    if ($Debug) { Write-Host "[$Level] $Message" }}function New-ModernButton {    param(        [string]$Text,        [System.Drawing.Size]$Size,        [System.Drawing.Point]$Location,        [System.Drawing.Color]$BackColor,        [System.Drawing.Color]$ForeColor = $script:Colors.White,        [int]$FontSize = 11,        [bool]$Glow = $false    )        $button = New-Object System.Windows.Forms.Button    $button.Text = $Text    $button.Size = $Size    $button.Location = $Location    $button.BackColor = $BackColor    $button.ForeColor = $ForeColor    $button.Font = New-Object System.Drawing.Font("Segoe UI", $FontSize, [System.Drawing.FontStyle]::Bold)    $button.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat    $button.FlatAppearance.BorderSize = 0    $button.Cursor = [System.Windows.Forms.Cursors]::Hand        # Arrondi moderne    $button.Region = [System.Drawing.Region]::FromHrgn([Win32.NativeMethods]::CreateRoundRectRgn(0, 0, $button.Width, $button.Height, 15, 15))        # Stocker couleur originale dans Tag (évite null reference)    $button.Tag = $BackColor        # Effet hover Web 3.0    $button.Add_MouseEnter({        $btn = $this        $baseColor = $btn.Tag        $btn.BackColor = [System.Drawing.Color]::FromArgb(            [Math]::Min(255, $baseColor.R + 30),            [Math]::Min(255, $baseColor.G + 30),            [Math]::Min(255, $baseColor.B + 30)        )    })    $button.Add_MouseLeave({        $btn = $this        $btn.BackColor = $btn.Tag    })        return $button}function Update-StatusText {    param([string]$Message, [string]$Color = "Green")    $colorObj = switch ($Color.ToLower()) {        "green"   { $script:Colors.Green }        "yellow"  { $script:Colors.Orange }        "red"     { $script:Colors.Red }        "cyan"    { [System.Drawing.Color]::Cyan }        "white"   { $script:Colors.White }        default   { $script:Colors.Green }    }    if ($null -ne $script:txtStatus) {        $script:txtStatus.SelectionStart = $script:txtStatus.TextLength        $script:txtStatus.SelectionColor = $colorObj        $script:txtStatus.AppendText("$Message`r`n")        $script:txtStatus.ScrollToCaret()        [System.Windows.Forms.Application]::DoEvents()    }    Write-Log $Message}function Show-Progress {    param([string]$Message, [int]$Duration = 2)    Update-StatusText $Message "Yellow"    if ($null -ne $script:progressBar) {        $script:progressBar.Value = 0        $script:progressBar.Visible = $true        for ($i = 0; $i -le 100; $i += 10) {            $script:progressBar.Value = $i            Start-Sleep -Milliseconds ($Duration * 10)            [System.Windows.Forms.Application]::DoEvents()        }        $script:progressBar.Visible = $false    }}# ============================================================================# FONCTIONS DNS# ============================================================================function Apply-AdZvancedDNS {    try {        Write-Log "Application des DNS AdZ-Vanced"        if ($null -ne $script:txtStatus) { $script:txtStatus.Clear() }                Show-Progress "Validation des serveurs DNS AdZ-Vanced..." 2        Update-StatusText "DNS AdZ-Vanced : Serveurs validés" "Green"                Show-Progress "Configuration des cartes réseau..." 3        $adapters = Get-CimInstance Win32_NetworkAdapterConfiguration | Where-Object { $_.IPEnabled -eq $true }        $successCount = 0                foreach ($adapter in $adapters) {            try {                $name = $adapter.Description                Update-StatusText "Configuration : $name" "Cyan"                                # Configuration IPv4                netsh interface ipv4 set dnsservers name="$name" static $script:Config.DNSIPv4Primary primary | Out-Null                netsh interface ipv4 add dnsservers name="$name" $script:Config.DNSIPv4Secondary index=2 | Out-Null                                # Configuration IPv6                netsh interface ipv6 set dnsservers name="$name" static $script:Config.DNSIPv6Primary primary | Out-Null                netsh interface ipv6 add dnsservers name="$name" $script:Config.DNSIPv6Secondary index=2 | Out-Null                                Update-StatusText "  DNS configurés avec succès" "Green"                $successCount++            }            catch {                Update-StatusText "  Erreur sur cette carte réseau" "Red"                Write-Log "Erreur carte $name : $($_.Exception.Message)" "ERROR"            }        }                Show-Progress "Actualisation du cache DNS..." 2        ipconfig /flushdns | Out-Null                if ($successCount -gt 0) {            Update-StatusText "" "White"            Update-StatusText "Configuration DNS AdZ-Vanced appliquée avec succès !" "Green"            Update-StatusText "Profitez maintenant d'un surf sain et rapide !" "Green"            Update-StatusText "$successCount carte(s) réseau configurée(s)" "Cyan"        } else {            Update-StatusText "Aucune carte réseau configurée" "Red"            [System.Windows.Forms.MessageBox]::Show("Aucune carte réseau n'a pu être configurée.", "Erreur", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Error)        }    }    catch {        Update-StatusText "Erreur critique : $($_.Exception.Message)" "Red"        Write-Log "Erreur Apply-AdZvancedDNS : $($_.Exception.Message)" "ERROR"        [System.Windows.Forms.MessageBox]::Show("Erreur critique : $($_.Exception.Message)", "Erreur Critique", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Error)    }}function Restore-DefaultDNS {    try {        Write-Log "Restauration DNS par défaut"        if ($null -ne $script:txtStatus) { $script:txtStatus.Clear() }                Show-Progress "Restauration des paramètres par défaut..." 2        $adapters = Get-CimInstance Win32_NetworkAdapterConfiguration | Where-Object { $_.IPEnabled -eq $true }        $successCount = 0                foreach ($adapter in $adapters) {            try {                $name = $adapter.Description                Update-StatusText "Restauration : $name" "Cyan"                                netsh interface ipv4 set dnsservers name="$name" dhcp | Out-Null                netsh interface ipv6 set dnsservers name="$name" dhcp | Out-Null                                Update-StatusText "  DNS restaurés" "Green"                $successCount++            }            catch {                Update-StatusText "  Erreur sur cette carte réseau" "Red"                Write-Log "Erreur restauration $name : $($_.Exception.Message)" "ERROR"            }        }                Show-Progress "Actualisation du cache DNS..." 2        ipconfig /flushdns | Out-Null                if ($successCount -gt 0) {            Update-StatusText "" "White"            Update-StatusText "DNS restaurés par défaut (DHCP)" "Green"            Update-StatusText "Retour aux DNS de votre FAI" "Cyan"            Update-StatusText "Paramètres réseau d'origine restaurés" "Cyan"        } else {            Update-StatusText "Erreur lors de la restauration" "Red"            [System.Windows.Forms.MessageBox]::Show("Aucune carte réseau restaurée.", "Erreur", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Error)        }    }    catch {        Update-StatusText "Erreur critique : $($_.Exception.Message)" "Red"        Write-Log "Erreur Restore-DefaultDNS : $($_.Exception.Message)" "ERROR"        [System.Windows.Forms.MessageBox]::Show("Erreur critique : $($_.Exception.Message)", "Erreur Critique", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Error)    }}# ============================================================================# INTERFACE GRAPHIQUE WEB 3.0# ============================================================================Write-Log "Initialisation interface $($script:Config.AppName) v$($script:Config.Version)"# Fenêtre principale$form = New-Object System.Windows.Forms.Form$form.Text = "$($script:Config.AppName) v$($script:Config.Version) - Configuration DNS"$form.Size = New-Object System.Drawing.Size(650, 750)$form.StartPosition = "CenterScreen"$form.FormBorderStyle = "FixedDialog"$form.MaximizeBox = $false$form.BackColor = $script:Colors.Black# Header violet dégradé$headerPanel = New-Object System.Windows.Forms.Panel$headerPanel.Size = New-Object System.Drawing.Size(650, 100)$headerPanel.Location = New-Object System.Drawing.Point(0, 0)$headerPanel.BackColor = $script:Colors.Purple$form.Controls.Add($headerPanel)# Titre principal$lblTitle = New-Object System.Windows.Forms.Label$lblTitle.Text = "AdZ-Vanced"$lblTitle.Font = New-Object System.Drawing.Font("Segoe UI", 32, [System.Drawing.FontStyle]::Bold)$lblTitle.ForeColor = $script:Colors.White$lblTitle.BackColor = [System.Drawing.Color]::Transparent$lblTitle.Size = New-Object System.Drawing.Size(650, 50)$lblTitle.Location = New-Object System.Drawing.Point(0, 15)$lblTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter$headerPanel.Controls.Add($lblTitle)# Version$lblVersion = New-Object System.Windows.Forms.Label$lblVersion.Text = "v$($script:Config.Version)"$lblVersion.Font = New-Object System.Drawing.Font("Segoe UI", 12)$lblVersion.ForeColor = $script:Colors.PurpleLight$lblVersion.BackColor = [System.Drawing.Color]::Transparent$lblVersion.Size = New-Object System.Drawing.Size(650, 25)$lblVersion.Location = New-Object System.Drawing.Point(0, 60)$lblVersion.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter$headerPanel.Controls.Add($lblVersion)# Panel logo arrondi$logoPanel = New-Object System.Windows.Forms.Panel$logoPanel.Size = New-Object System.Drawing.Size(220, 160)$logoPanel.Location = New-Object System.Drawing.Point(215, 110)$logoPanel.BackColor = $script:Colors.BlackSoft$form.Controls.Add($logoPanel)$logoPanel.Region = [System.Drawing.Region]::FromHrgn([Win32.NativeMethods]::CreateRoundRectRgn(0, 0, $logoPanel.Width, $logoPanel.Height, 20, 20))# Chargement logo avec fallback robustetry {    $logoPath = Join-Path $env:TEMP "adzvanced_logo.jpg"    Write-Log "Téléchargement logo : $($script:Config.LogoUrl)"    (New-Object System.Net.WebClient).DownloadFile($script:Config.LogoUrl, $logoPath)        $imageObj = $null    try {         $imageObj = [System.Drawing.Image]::FromFile($logoPath)         Write-Log "Logo chargé avec succès"    } catch {         Write-Log "Erreur chargement image : $($_.Exception.Message)" "WARNING"     }        if ($imageObj -ne $null) {        $picLogo = New-Object System.Windows.Forms.PictureBox        $picLogo.Image = $imageObj        $picLogo.SizeMode = 'StretchImage'        $picLogo.Size = New-Object System.Drawing.Size(220, 160)        $picLogo.Location = New-Object System.Drawing.Point(0, 0)        $logoPanel.Controls.Add($picLogo)    } else {        throw "Image non valide"    }}catch {    Write-Log "Fallback logo texte : $($_.Exception.Message)" "WARNING"    $lblLogoFallback = New-Object System.Windows.Forms.Label    $lblLogoFallback.Text = "LOGO`nAdZ-Vanced"    $lblLogoFallback.Font = New-Object System.Drawing.Font("Segoe UI", 18, [System.Drawing.FontStyle]::Bold)    $lblLogoFallback.ForeColor = $script:Colors.Purple    $lblLogoFallback.BackColor = [System.Drawing.Color]::Transparent    $lblLogoFallback.Size = New-Object System.Drawing.Size(220, 160)    $lblLogoFallback.Location = New-Object System.Drawing.Point(0, 0)    $lblLogoFallback.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter    $logoPanel.Controls.Add($lblLogoFallback)}# Panel marketing arrondi$msgPanel = New-Object System.Windows.Forms.Panel$msgPanel.Size = New-Object System.Drawing.Size(610, 80)$msgPanel.Location = New-Object System.Drawing.Point(20, 280)$msgPanel.BackColor = [System.Drawing.Color]::FromArgb(120, 85, 60, 148)$form.Controls.Add($msgPanel)$msgPanel.Region = [System.Drawing.Region]::FromHrgn([Win32.NativeMethods]::CreateRoundRectRgn(0, 0, $msgPanel.Width, $msgPanel.Height, 20, 20))$lblMessage = New-Object System.Windows.Forms.Label$lblMessage.Text = "Grâce à AdZ-Vanced, vous allez enfin pouvoir profiter d'un surf sain et rapide.`nPas de pub, pas de données personnelles qui fuitent et vive le contournement imposé par les FAI."$lblMessage.Font = New-Object System.Drawing.Font("Segoe UI", 11, [System.Drawing.FontStyle]::Bold)$lblMessage.ForeColor = $script:Colors.White$lblMessage.BackColor = [System.Drawing.Color]::Transparent$lblMessage.Size = New-Object System.Drawing.Size(600, 65)$lblMessage.Location = New-Object System.Drawing.Point(5, 7)$lblMessage.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter$msgPanel.Controls.Add($lblMessage)# Boutons principaux Web 3.0$btnInstall = New-ModernButton -Text "INSTALLER DNS" -Size (New-Object System.Drawing.Size(265, 55)) -Location (New-Object System.Drawing.Point(40, 370)) -BackColor $script:Colors.Purple -FontSize 13 -Glow $true$form.Controls.Add($btnInstall)$btnRestore = New-ModernButton -Text "RESTAURER DNS" -Size (New-Object System.Drawing.Size(265, 55)) -Location (New-Object System.Drawing.Point(340, 370)) -BackColor $script:Colors.GrayDark -FontSize 13 -Glow $true$form.Controls.Add($btnRestore)# Journal des opérations$lblStatusTitle = New-Object System.Windows.Forms.Label$lblStatusTitle.Text = "Journal des opérations"$lblStatusTitle.Font = New-Object System.Drawing.Font("Segoe UI", 13, [System.Drawing.FontStyle]::Bold)$lblStatusTitle.ForeColor = $script:Colors.White$lblStatusTitle.BackColor = [System.Drawing.Color]::Transparent$lblStatusTitle.Size = New-Object System.Drawing.Size(340, 25)$lblStatusTitle.Location = New-Object System.Drawing.Point(35, 445)$form.Controls.Add($lblStatusTitle)$txtStatus = New-Object System.Windows.Forms.RichTextBox$txtStatus.Size = New-Object System.Drawing.Size(565, 145)$txtStatus.Location = New-Object System.Drawing.Point(40, 480)$txtStatus.ReadOnly = $true$txtStatus.BackColor = $script:Colors.Black$txtStatus.ForeColor = $script:Colors.Green$txtStatus.Font = New-Object System.Drawing.Font("Consolas", 10)$txtStatus.ScrollBars = "Vertical"$txtStatus.Text = "Prêt à configurer vos DNS AdZ-Vanced...`r`n`r`nCliquez sur 'INSTALLER DNS' pour commencer`r`nou sur 'RESTAURER DNS' pour revenir aux paramètres par défaut.`r`n`r`nTous vos paramètres actuels seront sauvegardés automatiquement."$form.Controls.Add($txtStatus)$script:txtStatus = $txtStatus# Barre de progression$progressBar = New-Object System.Windows.Forms.ProgressBar$progressBar.Size = New-Object System.Drawing.Size(565, 8)$progressBar.Location = New-Object System.Drawing.Point(40, 630)$progressBar.Style = 'Continuous'$progressBar.ForeColor = $script:Colors.Purple$progressBar.Visible = $false$form.Controls.Add($progressBar)$script:progressBar = $progressBar# Boutons du bas$btnDonation = New-ModernButton -Text "Donation" -Size (New-Object System.Drawing.Size(125, 35)) -Location (New-Object System.Drawing.Point(40, 655)) -BackColor $script:Colors.Purple -FontSize 11$form.Controls.Add($btnDonation)$btnTelegram = New-ModernButton -Text "Telegram" -Size (New-Object System.Drawing.Size(125, 35)) -Location (New-Object System.Drawing.Point(180, 655)) -BackColor $script:Colors.Purple -FontSize 11$form.Controls.Add($btnTelegram)$btnInfo = New-ModernButton -Text "Info" -Size (New-Object System.Drawing.Size(125, 35)) -Location (New-Object System.Drawing.Point(320, 655)) -BackColor $script:Colors.Purple -FontSize 11$form.Controls.Add($btnInfo)$btnClose = New-ModernButton -Text "Fermer" -Size (New-Object System.Drawing.Size(125, 35)) -Location (New-Object System.Drawing.Point(460, 655)) -BackColor $script:Colors.Red -FontSize 11$form.Controls.Add($btnClose)# ============================================================================# ÉVÉNEMENTS# ============================================================================# Installation DNS$btnInstall.Add_Click({    $btnInstall.Enabled = $false    $btnRestore.Enabled = $false    Apply-AdZvancedDNS    $btnInstall.Enabled = $true    $btnRestore.Enabled = $true})# Restauration DNS$btnRestore.Add_Click({    $btnInstall.Enabled = $false    $btnRestore.Enabled = $false    Restore-DefaultDNS    $btnInstall.Enabled = $true    $btnRestore.Enabled = $true})# Modal Donation Web 3.0$btnDonation.Add_Click({    $donForm = New-Object System.Windows.Forms.Form    $donForm.Text = "Soutenir AdZ-Vanced"    $donForm.Size = New-Object System.Drawing.Size(380, 250)    $donForm.StartPosition = "CenterParent"    $donForm.BackColor = $script:Colors.BlackSoft    $donForm.FormBorderStyle = "FixedDialog"    $donForm.MaximizeBox = $false        # Titre modal    $lblDonTitle = New-Object System.Windows.Forms.Label    $lblDonTitle.Text = "Soutenez le développement !"    $lblDonTitle.Font = New-Object System.Drawing.Font("Segoe UI", 14, [System.Drawing.FontStyle]::Bold)    $lblDonTitle.ForeColor = $script:Colors.White    $lblDonTitle.Size = New-Object System.Drawing.Size(360, 30)    $lblDonTitle.Location = New-Object System.Drawing.Point(10, 15)    $lblDonTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter    $donForm.Controls.Add($lblDonTitle)        # Boutons donation    $btnPayPal = New-ModernButton -Text "PayPal" -Size (New-Object System.Drawing.Size(300, 40)) -Location (New-Object System.Drawing.Point(40, 60)) -BackColor $script:Colors.Purple    $btnPayPal.Add_Click({ Start-Process $script:Config.DonationPayPal })    $donForm.Controls.Add($btnPayPal)        $btnTipeee = New-ModernButton -Text "Tipeee" -Size (New-Object System.Drawing.Size(300, 40)) -Location (New-Object System.Drawing.Point(40, 110)) -BackColor $script:Colors.Orange    $btnTipeee.Add_Click({ Start-Process $script:Config.DonationTipeee })    $donForm.Controls.Add($btnTipeee)        $btnRetour = New-ModernButton -Text "Retour" -Size (New-Object System.Drawing.Size(300, 40)) -Location (New-Object System.Drawing.Point(40, 160)) -BackColor $script:Colors.Gray    $btnRetour.Add_Click({ $donForm.Close() })    $donForm.Controls.Add($btnRetour)        $donForm.ShowDialog($form) | Out-Null})# Autres événements$btnTelegram.Add_Click({ Start-Process $script:Config.TelegramUrl })$btnInfo.Add_Click({    $infoMsg = "AdZ-Vanced v$($script:Config.Version)`n`nConfiguration DNS professionnelle pour un surf sain et rapide.`n`nServeurs DNS :`n• IPv4: $($script:Config.DNSIPv4Primary) / $($script:Config.DNSIPv4Secondary)`n• IPv6: $($script:Config.DNSIPv6Primary) / $($script:Config.DNSIPv6Secondary)`n`nAvantages :`n• Blocage des publicités`n• Protection vie privée`n• Navigation plus rapide`n• Contournement restrictions FAI`n`n© 2025 KontacktzBot"    [System.Windows.Forms.MessageBox]::Show($infoMsg, "Informations AdZ-Vanced", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Information)})$btnClose.Add_Click({ $form.Close() })# ============================================================================# LANCEMENT# ============================================================================Write-Log "Interface initialisée avec succès"$form.Add_Shown({ $form.Activate() })[void]$form.ShowDialog()Write-Log "Application fermée"